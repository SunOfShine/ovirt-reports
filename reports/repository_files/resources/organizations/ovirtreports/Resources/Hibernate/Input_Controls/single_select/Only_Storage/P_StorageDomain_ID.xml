<?xml version="1.0" encoding="UTF-8"?>
<inputControl>
    <folder>/organizations/ovirtreports/Resources/Hibernate/Input_Controls/single_select/Only_Storage</folder>
    <name>P_StorageDomain_ID</name>
    <version>3</version>
    <label>Storage Domain Name</label>
    <description>Storage Domain Name</description>
    <creationDate>2011-10-18T16:58:24.000+02:00</creationDate>
    <updateDate>2011-10-18T17:50:20.000+02:00</updateDate>
    <type>4</type>
    <mandatory>true</mandatory>
    <readOnly>false</readOnly>
    <visible>true</visible>
    <query>
        <localResource
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="query">
            <folder>/organizations/ovirtreports/Resources/Hibernate/Input_Controls/single_select/Only_Storage/P_StorageDomain_ID_files</folder>
            <name>Storage_Domain_Name</name>
            <version>1</version>
            <label>Storage_Domain_Name</label>
            <description>Storage Domain Query</description>
            <creationDate>2011-10-18T17:50:20.000+02:00</creationDate>
            <updateDate>2011-10-18T17:50:20.000+02:00</updateDate>
            <language>hql</language>
            <queryString>SELECT DISTINCT o.storageDomainId, (CASE
						        			WHEN o.detachDate IS NULL then h.storageDomainName 
						        			ELSE (h.storageDomainName || ' (Detached on ' || cast(max(o.detachDate) as string) || ')')  
			        				END) as storageDomainNameIc, o.detachDate as detachDate
FROM V23StorageDomainConfigurationView as h, V23DatacenterStorageDomainMapView as o
WHERE o.storageDomainId = h.storageDomainId
	 AND o.datacenterId = $P{P_DataCenter_ID}
	 AND h.storageDomainType = CASE 
								WHEN $P{P_Storage_Type} IS NULL THEN  h.storageDomainType
								WHEN $P{P_Storage_Type} = -1 THEN h.storageDomainType
								ELSE $P{P_Storage_Type}
					      	   END
	 AND o.historyId = (SELECT max(a.historyId)
	 					FROM V23DatacenterStorageDomainMapView a
	 					WHERE a.datacenterId = o.datacenterId
	 						  AND a.storageDomainId = o.storageDomainId)
order by o.detachDate DESC</queryString>
            <dataSource>
                <uri>/organizations/ovirtreports/Resources/Hibernate/data_sources/ovirt-hibernate</uri>
            </dataSource>
        </localResource>
    </query>
    <queryVisibleColumn>storageDomainNameIc</queryVisibleColumn>
    <queryValueColumn>storageId</queryValueColumn>
</inputControl>
