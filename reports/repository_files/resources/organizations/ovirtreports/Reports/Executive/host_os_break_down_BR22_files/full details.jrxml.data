<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report1" language="groovy" pageWidth="830" pageHeight="88" orientation="Landscape" columnWidth="830" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="ireport.jasperserver.reportUnit" value="/organizations/ovirtreports/Reports/Executive/host_os_break_down_BR22"/>
	<property name="ireport.jasperserver.url" value="http://localhost:8080/jasperserver/services/repository"/>
	<parameter name="P_DataCenter_ID" class="java.lang.String">
		<parameterDescription><![CDATA[Select a DataCenter]]></parameterDescription>
		<defaultValueExpression><![CDATA["00000000-0000-0000-0000-000000000000"]]></defaultValueExpression>
	</parameter>
	<parameter name="P_Cluster_ID" class="java.lang.String">
		<parameterDescription><![CDATA[Select a Cluster]]></parameterDescription>
		<defaultValueExpression><![CDATA["00000000-0000-0000-0000-000000000000"]]></defaultValueExpression>
	</parameter>
	<parameter name="P_Host_Type" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[-1]]></defaultValueExpression>
	</parameter>
	<parameter name="P_Period" class="java.lang.String"/>
	<parameter name="P_Dates" class="java.lang.String"/>
	<parameter name="P_End_Date" class="java.lang.String">
		<defaultValueExpression><![CDATA["01/01/2000"]]></defaultValueExpression>
	</parameter>
	<parameter name="P_Start_Date" class="java.lang.String">
		<defaultValueExpression><![CDATA["01/01/2000"]]></defaultValueExpression>
	</parameter>
	<parameter name="active_hosts_select" class="java.lang.String">
		<defaultValueExpression><![CDATA["AND delete_date IS NULL"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT	v3_0_datacenter_configuration_view.datacenter_name as datacenter_name,
     	v3_0_datacenter_configuration_view.delete_date as datacenter_delete_date,
      	coalesce((SELECT ' ' || v3_0_cluster_configuration_view.cluster_name
		  FROM v3_0_cluster_configuration_view
	          WHERE v3_0_cluster_configuration_view.cluster_id = cast($P{P_Cluster_ID} as uuid)
		        and v3_0_cluster_configuration_view.history_id = (SELECT max(a.history_id)
				 					  FROM v3_0_cluster_configuration_view as a
							 		  WHERE a.cluster_id = v3_0_cluster_configuration_view.cluster_id)), 's') as cluster_name,
    	(SELECT v3_0_cluster_configuration_view.delete_date
    	 FROM v3_0_cluster_configuration_view
         WHERE v3_0_cluster_configuration_view.cluster_id = cast($P{P_Cluster_ID} as uuid)
	      and v3_0_cluster_configuration_view.history_id = (SELECT max(a.history_id)
							        FROM v3_0_cluster_configuration_view as a
							        WHERE a.cluster_id = v3_0_cluster_configuration_view.cluster_id)) as cluster_delete_date,
        coalesce((SELECT v3_0_enum_translator_view.value
	          FROM v3_0_enum_translator_view
		  WHERE v3_0_enum_translator_view.enum_key = $P{P_Host_Type}
		  AND v3_0_enum_translator_view.enum_type = 'HOST_TYPE'), 'All') as host_type
FROM v3_0_datacenter_configuration_view
WHERE 	v3_0_datacenter_configuration_view.datacenter_id = cast($P{P_DataCenter_ID} as uuid)
	and v3_0_datacenter_configuration_view.history_id = (SELECT max(a.history_id)
							     FROM v3_0_datacenter_configuration_view as a
							     WHERE a.datacenter_id = v3_0_datacenter_configuration_view.datacenter_id)]]>
	</queryString>
	<field name="datacenter_name" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="datacenter_delete_date" class="java.sql.Timestamp">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="cluster_name" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="cluster_delete_date" class="java.sql.Timestamp">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="host_type" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<variable name="datacenter_star" class="java.lang.String" resetType="None">
		<variableExpression><![CDATA[$F{datacenter_delete_date} != null ? "*" : ""]]></variableExpression>
	</variable>
	<variable name="cluster_star" class="java.lang.String" resetType="None">
		<variableExpression><![CDATA[$F{cluster_delete_date} != null ? "*" : ""]]></variableExpression>
	</variable>
	<title>
		<band height="88" splitType="Stretch">
			<frame>
				<reportElement mode="Opaque" x="1" y="30" width="828" height="40"/>
				<box>
					<pen lineWidth="1.0" lineColor="#CCCCCC"/>
					<topPen lineWidth="1.0" lineColor="#CCCCCC"/>
					<leftPen lineWidth="1.0" lineColor="#CCCCCC"/>
					<bottomPen lineWidth="1.0" lineColor="#CCCCCC"/>
					<rightPen lineWidth="1.0" lineColor="#CCCCCC"/>
				</box>
				<textField>
					<reportElement x="88" y="0" width="385" height="20"/>
					<textElement verticalAlignment="Middle" markup="html">
						<font fontName="DejaVu Sans" size="11" isBold="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
					</textElement>
					<textFieldExpression><![CDATA["<b>Datacenter: </b>" + $F{datacenter_name} + $V{datacenter_star}]]></textFieldExpression>
					<hyperlinkTooltipExpression><![CDATA[$F{datacenter_name} + $V{datacenter_star}]]></hyperlinkTooltipExpression>
				</textField>
				<textField>
					<reportElement positionType="Float" x="88" y="20" width="385" height="20"/>
					<textElement textAlignment="Justified" verticalAlignment="Middle" markup="html">
						<font fontName="DejaVu Sans" size="11" isBold="false"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{cluster_name} != "s" ? "<b>Cluster: </b>" + $F{cluster_name} + $V{cluster_star} : "<b>Cluster: </b> All"]]></textFieldExpression>
					<hyperlinkTooltipExpression><![CDATA[$F{cluster_name} != "s" ? $F{cluster_name} + $V{cluster_star} : "All"]]></hyperlinkTooltipExpression>
				</textField>
				<textField>
					<reportElement positionType="Float" x="593" y="0" width="235" height="20"/>
					<textElement textAlignment="Justified" verticalAlignment="Middle" markup="html">
						<font fontName="DejaVu Sans" size="11" isBold="false"/>
					</textElement>
					<textFieldExpression><![CDATA["<b>Date Range: </b>" + $P{P_Start_Date} + " - " + $P{P_End_Date}]]></textFieldExpression>
					<hyperlinkTooltipExpression><![CDATA[$P{P_Start_Date} + " - " + $P{P_End_Date}]]></hyperlinkTooltipExpression>
				</textField>
				<textField>
					<reportElement positionType="Float" x="483" y="0" width="107" height="20"/>
					<textElement textAlignment="Justified" verticalAlignment="Middle" markup="html">
						<font fontName="DejaVu Sans" size="11" isBold="false"/>
					</textElement>
					<textFieldExpression><![CDATA["<b>Period: </b>" + $P{P_Period}]]></textFieldExpression>
					<hyperlinkTooltipExpression><![CDATA[$P{P_Period}]]></hyperlinkTooltipExpression>
				</textField>
				<staticText>
					<reportElement mode="Opaque" x="2" y="2" width="69" height="36" forecolor="#666666" backcolor="#E6E6E6"/>
					<box>
						<pen lineWidth="1.0" lineColor="#F0F0F0"/>
						<topPen lineWidth="1.0" lineColor="#F0F0F0"/>
						<leftPen lineWidth="1.0" lineColor="#F0F0F0"/>
						<bottomPen lineWidth="1.0" lineColor="#F0F0F0"/>
						<rightPen lineWidth="1.0" lineColor="#F0F0F0"/>
					</box>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font fontName="DejaVu Sans" size="13" isBold="true"/>
					</textElement>
					<text><![CDATA[ Criteria:]]></text>
				</staticText>
				<textField>
					<reportElement positionType="Float" x="483" y="20" width="345" height="20"/>
					<textElement textAlignment="Justified" verticalAlignment="Middle" markup="html">
						<font fontName="DejaVu Sans" size="11" isBold="false"/>
					</textElement>
					<textFieldExpression><![CDATA[$P{active_hosts_select} == "/**/" ? "<b>Show Deleted Hosts: </b> Yes" :"<b>Show Deleted Hosts: </b> No"]]></textFieldExpression>
					<hyperlinkTooltipExpression><![CDATA[$P{active_hosts_select} == "/**/" ? "No" :"Yes"]]></hyperlinkTooltipExpression>
				</textField>
			</frame>
			<textField evaluationTime="Report" isBlankWhenNull="false">
				<reportElement x="0" y="0" width="830" height="25" forecolor="#666666"/>
				<textElement textAlignment="Left" verticalAlignment="Top" markup="html">
					<font fontName="DejaVu Sans" size="17" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false"/>
				</textElement>
				<textFieldExpression><![CDATA["Host OS Break Down in <b>Cluster" + $F{cluster_name} + $V{cluster_star} + "</b> of <b>Data Center " + $F{datacenter_name} + $V{datacenter_star} + "</b>"]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="12" y="74" width="10" height="11">
					<printWhenExpression><![CDATA[$F{cluster_delete_date} != null || $F{datacenter_delete_date} != null]]></printWhenExpression>
				</reportElement>
				<imageExpression><![CDATA["repo:trash-icon"]]></imageExpression>
			</image>
			<staticText>
				<reportElement x="5" y="74" width="5" height="14" forecolor="#666666">
					<printWhenExpression><![CDATA[$F{cluster_delete_date} != null || $F{datacenter_delete_date} != null]]></printWhenExpression>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font fontName="DejaVu Sans" size="12"/>
				</textElement>
				<text><![CDATA[*]]></text>
			</staticText>
			<textField>
				<reportElement x="29" y="74" width="735" height="14" forecolor="#666666"/>
				<textElement markup="html">
					<font fontName="DejaVu Sans"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{cluster_delete_date} != null ?
$F{datacenter_delete_date} != null ? "The data center was deleted on " + $F{datacenter_delete_date}.toString() + " and the cluster was deleted on " + $F{cluster_delete_date}.toString() + "." :
"The cluster was deleted on " + $F{cluster_delete_date}.toString() + "." :
$F{datacenter_delete_date} != null ? "The data center was deleted on " + $F{datacenter_delete_date}.toString() + "." : ""]]></textFieldExpression>
			</textField>
		</band>
	</title>
</jasperReport>
